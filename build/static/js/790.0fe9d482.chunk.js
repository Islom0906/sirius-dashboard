"use strict";(self.webpackChunkevolution_motors=self.webpackChunkevolution_motors||[]).push([[790],{53016:(e,t,a)=>{a.d(t,{Z:()=>r});a(72791);var i=a(2409),s=a(49389),l=a(80184);const r=e=>{let{label:t,name:a,required:r,required_text:n,warning:o}=e;return(0,l.jsx)(i.Z.Item,{label:o?(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{children:t}),(0,l.jsx)("br",{}),(0,l.jsx)("p",{children:o})]}):(0,l.jsx)("div",{children:t}),name:a,rules:[{required:r,message:n}],children:(0,l.jsx)(s.default,{})})}},87790:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Z});var i=a(72791),s=a(2409),l=a(50419),r=a(66106),n=a(30914),o=a(83734),d=a(93086),u=a(87309),c=a(91933),m=a(27169),p=a(98284),g=a(57689),v=a(16030),x=a(46273),h=a(77221),f=a(53016),b=a(80184);const j={image:[],title_uz:"",title_ru:"",is_index:null},Z=()=>{var e;const[t]=s.Z.useForm(),a=(0,g.s0)(),{editId:Z}=(0,v.v9)((e=>e.editData)),_=(0,v.I0)(),[w,y]=(0,i.useState)([]),{data:F,refetch:S}=(0,c.useQuery)("get-category",(()=>m.Z.getData("/categories/")),{enabled:!1}),{mutate:I,data:q,isLoading:E,isSuccess:L}=(0,c.useMutation)((e=>{let{url:t,data:a}=e;return m.Z.postData(t,a)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let t in e.response.data)l.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{isLoading:D,data:P,refetch:V,isSuccess:C}=(0,c.useQuery)(["edit-category",Z],(()=>m.Z.getDataByID("/categories",Z)),{enabled:!1}),{mutate:z,isLoading:O,data:k,isSuccess:M}=(0,c.useMutation)((e=>{let{url:t,data:a,id:i}=e;return m.Z.editData(t,a,i)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let t in e.response.data)l.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}});(0,i.useEffect)((()=>{M&&_({type:h.Pb,payload:""}),(L||M)&&a("/category")}),[q,k]),(0,i.useEffect)((()=>{""!==Z&&V()}),[Z]),(0,i.useEffect)((()=>{""===Z&&(t.setFieldsValue(j),S())}),[]),(0,i.useEffect)((()=>{const e=[{uid:null===P||void 0===P?void 0:P.id,name:null===P||void 0===P?void 0:P.id,status:"done",url:null===P||void 0===P?void 0:P.image}];if(C){const a={image:e,title_uz:P.title_uz,title_ru:P.title_ru,is_index:P.is_index};y(e),t.setFieldsValue(a)}}),[P]);(0,i.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],t.setFieldsValue(e));const a=()=>{localStorage.setItem("myFormValues",JSON.stringify(t.getFieldsValue()))};return window.addEventListener("beforeunload",a),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",a)}}),[]);const T=(0,i.useMemo)((()=>{var e;if(F)return[{value:!0,label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c",disabled:(null===(e=F[0])||void 0===e?void 0:e.count)>8},{value:!1,label:"\u041d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0439"}]}),[F]);return(0,b.jsx)("div",{children:E||D||O?(0,b.jsx)(p.QP,{}):(0,b.jsxs)(s.Z,{form:t,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:j,onFinish:e=>{var t;const a=new FormData;var i;(a.append("title_uz",e.title_uz),a.append("title_ru",e.title_ru),a.append("is_index",e.is_index),null!==(t=w[0])&&void 0!==t&&t.originFileObj)&&a.append("image",null===(i=w[0])||void 0===i?void 0:i.originFileObj);C?z({url:"/categories",data:a,id:Z}):I({url:"/categories/",data:a})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,b.jsxs)(r.Z,{gutter:20,children:[(0,b.jsx)(n.Z,{span:12,children:(0,b.jsx)(f.Z,{required:!0,required_text:"Sarlavha talab qilinadi",label:"Sarlavha Uz",name:"title_uz"})}),(0,b.jsx)(n.Z,{span:12,children:(0,b.jsx)(f.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a",label:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a Ru",name:"title_ru"})})]}),(0,b.jsxs)(r.Z,{gutter:20,children:[(0,b.jsx)(n.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:"\u0421\u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u043e\u043d \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u043b\u0441\u044f \u0432 \u0432\u0438\u0434\u0435 \u0431\u0430\u043d\u043d\u0435\u0440\u0430 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435. \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u043e\u0432 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435: ".concat(F&&(null===(e=F[0])||void 0===e?void 0:e.count)),name:"is_index",rules:[{required:!0,message:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u044b"}],wrapperCol:{span:24},children:(0,b.jsx)(o.default,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",optionLabelProp:"label",options:T})})}),(0,b.jsx)(n.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439",name:"image",rules:[{required:!0,message:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0430\u043d\u043d\u0435\u0440\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043e."}],children:(0,b.jsx)(x.Z,{children:(0,b.jsx)(d.Z,{maxCount:1,fileList:w,listType:"picture-card",onChange:e=>{let{fileList:a}=e;y(a),t.setFieldsValue({image:a})},onPreview:async e=>{let t=e.url;t||(t=await new Promise((t=>{const a=new FileReader;a.readAsDataURL(e.originFileObj),a.onload=()=>t(a.result)})));const a=new Image;a.src=t;const i=window.open(t);null===i||void 0===i||i.document.write(a.outerHTML)},beforeUpload:()=>!1,children:w.length>0?"":"Upload"})})})})]}),(0,b.jsx)(u.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:C?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=790.0fe9d482.chunk.js.map