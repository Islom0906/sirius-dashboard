"use strict";(self.webpackChunksirius_tech_motors=self.webpackChunksirius_tech_motors||[]).push([[861],{53016:(e,t,i)=>{i.d(t,{Z:()=>l});i(72791);var a=i(2409),r=i(49389),s=i(80184);const l=e=>{let{label:t,name:i,required:l,required_text:n,warning:o}=e;return(0,s.jsx)(a.Z.Item,{label:o?(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:t}),(0,s.jsx)("br",{}),(0,s.jsx)("p",{children:o})]}):(0,s.jsx)("div",{children:t}),name:i,rules:[{required:l,message:n}],children:(0,s.jsx)(r.default,{})})}},87790:(e,t,i)=>{i.r(t),i.d(t,{default:()=>_});var a=i(72791),r=i(521),s=i(2409),l=i(50419),n=i(66106),o=i(30914),d=i(83734),u=i(93086),c=i(87309),m=i(91933),p=i(27169),g=i(93165),v=i(57689),f=i(16030),h=i(46273),x=i(77221),j=i(53016),y=i(80184);const{Title:b}=r.default,Z={image:[],title_uz:"",title_ru:"",is_index:null},_=()=>{const[e]=s.Z.useForm(),t=(0,v.s0)(),{editId:i}=(0,f.v9)((e=>e.editData)),r=(0,f.I0)(),[_,w]=(0,a.useState)([]),{data:F,refetch:S}=(0,m.useQuery)("get-category-count",(()=>p.Z.getData("/categories-count/")),{enabled:!1}),{mutate:E,data:I,isLoading:q,isSuccess:L}=(0,m.useMutation)((e=>{let{url:t,data:i}=e;return p.Z.postData(t,i)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let t in e.response.data)l.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{isLoading:D,data:P,refetch:V,isSuccess:C}=(0,m.useQuery)(["edit-category",i],(()=>p.Z.getDataByID("/categories",i)),{enabled:!1}),{mutate:z,isLoading:A,data:O,isSuccess:T}=(0,m.useMutation)((e=>{let{url:t,data:i,id:a}=e;return p.Z.editData(t,i,a)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let t in e.response.data)l.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}});(0,a.useEffect)((()=>{T&&r({type:x.Pb,payload:""}),(L||T)&&t("/category")}),[I,O]),(0,a.useEffect)((()=>{""!==i&&V()}),[i]),(0,a.useEffect)((()=>{""===i&&e.setFieldsValue(Z),S()}),[]),(0,a.useEffect)((()=>{const t=[{uid:null===P||void 0===P?void 0:P.id,name:null===P||void 0===P?void 0:P.id,status:"done",url:null===P||void 0===P?void 0:P.image}];if(C){const i={image:t,title_uz:P.title_uz,title_ru:P.title_ru,is_index:P.is_index};w(t),e.setFieldsValue(i)}}),[P]);(0,a.useEffect)((()=>{const t=JSON.parse(localStorage.getItem("myFormValues"));t&&(t.images=[],e.setFieldsValue(t));const i=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",i),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",i)}}),[]);const k=(0,a.useMemo)((()=>{if(F)return[{value:!0,label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c",disabled:(null===F||void 0===F?void 0:F.count)>6},{value:!1,label:"\u041d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0439"}]}),[F]);return(0,y.jsx)("div",{children:q||D||A?(0,y.jsx)(g.QP,{}):(0,y.jsxs)(s.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:Z,onFinish:e=>{var t;const a=new FormData;var r;(a.append("title_uz",e.title_uz),a.append("title_ru",e.title_ru),a.append("is_index",e.is_index),null!==(t=_[0])&&void 0!==t&&t.originFileObj)&&a.append("image",null===(r=_[0])||void 0===r?void 0:r.originFileObj);C?z({url:"/categories",data:a,id:i}):E({url:"/categories/",data:a})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,y.jsxs)(n.Z,{gutter:20,children:[(0,y.jsx)(o.Z,{span:12,children:(0,y.jsx)(j.Z,{required:!0,required_text:"Sarlavha talab qilinadi",label:"Sarlavha Uz",name:"title_uz"})}),(0,y.jsx)(o.Z,{span:12,children:(0,y.jsx)(j.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a",label:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a Ru",name:"title_ru"})})]}),(0,y.jsxs)(n.Z,{gutter:20,children:[(0,y.jsxs)(o.Z,{span:12,children:[(0,y.jsxs)(b,{level:5,children:["\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u043e\u0432 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435: ",F&&(null===F||void 0===F?void 0:F.count)]}),(0,y.jsx)(s.Z.Item,{label:"\u0421\u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u043e\u043d \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u043b\u0441\u044f \u0432 \u0432\u0438\u0434\u0435 \u0431\u0430\u043d\u043d\u0435\u0440\u0430 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435.",name:"is_index",rules:[{required:!0,message:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u044b"}],wrapperCol:{span:24},children:(0,y.jsx)(d.default,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",optionLabelProp:"label",options:k})})]}),(0,y.jsx)(o.Z,{span:12,children:(0,y.jsx)(s.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439",name:"image",rules:[{required:!0,message:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0430\u043d\u043d\u0435\u0440\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043e."}],children:(0,y.jsx)(h.Z,{children:(0,y.jsx)(u.Z,{maxCount:1,fileList:_,listType:"picture-card",onChange:t=>{let{fileList:i}=t;w(i),e.setFieldsValue({image:i})},onPreview:async e=>{let t=e.url;t||(t=await new Promise((t=>{const i=new FileReader;i.readAsDataURL(e.originFileObj),i.onload=()=>t(i.result)})));const i=new Image;i.src=t;const a=window.open(t);null===a||void 0===a||a.document.write(i.outerHTML)},beforeUpload:()=>!1,children:_.length>0?"":"Upload"})})})})]}),(0,y.jsx)(c.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:C?"Edit":"Add"})]})})}},42748:(e,t,i)=>{i.d(t,{G:()=>l});var a=i(14937),r=function(e){if((0,a.Z)()&&window.document.documentElement){var t=Array.isArray(e)?e:[e],i=window.document.documentElement;return t.some((function(e){return e in i.style}))}return!1},s=function(e,t){if(!r(e))return!1;var i=document.createElement("div"),a=i.style[e];return i.style[e]=t,i.style[e]!==a};function l(e,t){return Array.isArray(e)||void 0===t?r(e):s(e,t)}}}]);
//# sourceMappingURL=861.6a7ca418.chunk.js.map