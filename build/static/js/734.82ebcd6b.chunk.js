"use strict";(self.webpackChunkevolution_motors=self.webpackChunkevolution_motors||[]).push([[734],{46734:(e,a,t)=>{t.r(a),t.d(a,{default:()=>w});var s=t(72791),r=t(2409),n=t(50419),o=t(66106),i=t(30914),l=t(49389),d=t(93086),u=t(87309),c=t(91933),m=t(27169),p=t(98284),g=t(57689),f=t(16030),h=t(77221),b=t(46273),F=t(80184);const v={url:"",image:[]},w=()=>{const[e]=r.Z.useForm(),a=(0,g.s0)(),{editId:t}=(0,f.v9)((e=>e.editData)),w=(0,f.I0)(),[Z,j]=(0,s.useState)([]),{mutate:x,data:y,isLoading:S,isSuccess:I}=(0,c.useMutation)((e=>{let{url:a,data:t}=e;return m.Z.postData(a,t)}),{onSuccess:()=>{n.ZP.success("Success")},onError:e=>{for(let a in e.response.data)n.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}}),{isLoading:E,data:L,refetch:V,isSuccess:D}=(0,c.useQuery)(["edit-banner",t],(()=>m.Z.getDataByID("/about/header-banner",t)),{enabled:!1}),{mutate:P,isLoading:C,data:O,isSuccess:k}=(0,c.useMutation)((e=>{let{url:a,data:t,id:s}=e;return m.Z.editData(a,t,s)}),{onSuccess:()=>{n.ZP.success("Success")},onError:e=>{for(let a in e.response.data)n.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}});(0,s.useEffect)((()=>{k&&w({type:h.Pb,payload:""}),(I||k)&&a("/banner")}),[y,O]),(0,s.useEffect)((()=>{""!==t&&V()}),[t]),(0,s.useEffect)((()=>{""===t&&e.setFieldsValue(v)}),[]),(0,s.useEffect)((()=>{if(D){const a=[{uid:L.id,name:L.id,status:"done",url:L.image}],t={url:L.url.split("//")[1],image:a};j(a),e.setFieldsValue(t)}}),[L]);(0,s.useEffect)((()=>{const a=JSON.parse(localStorage.getItem("myFormValues"));a&&(a.images=[],e.setFieldsValue(a));const t=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",t),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);return(0,F.jsx)("div",{children:S||E||C?(0,F.jsx)(p.QP,{}):(0,F.jsxs)(r.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:v,onFinish:e=>{var a;const s=new FormData;var r;(s.append("url","https://".concat(e.url)),null!==(a=Z[0])&&void 0!==a&&a.originFileObj)&&s.append("image",null===(r=Z[0])||void 0===r?void 0:r.originFileObj);L?P({url:"/about/header-banner",data:s,id:t}):x({url:"/about/header-banner/",data:s})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,F.jsxs)(o.Z,{gutter:20,children:[(0,F.jsx)(i.Z,{span:12,children:(0,F.jsx)(r.Z.Item,{label:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0431\u0430\u043d\u043d\u0435\u0440",name:"url",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0431\u0430\u043d\u043d\u0435\u0440"}],children:(0,F.jsx)(l.default,{addonBefore:"https://"})})}),(0,F.jsx)(i.Z,{span:12,children:(0,F.jsx)(r.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0430\u043d\u043d\u0435\u0440\u0430",name:"image",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0430\u043d\u043d\u0435\u0440\u0430."}],children:(0,F.jsx)(b.Z,{rotationSlider:!0,children:(0,F.jsx)(d.Z,{maxCount:1,fileList:Z,listType:"picture-card",onChange:a=>{let{fileList:t}=a;j(t),e.setFieldsValue({image:t})},onPreview:async e=>{let a=e.url;a||(a=await new Promise((a=>{const t=new FileReader;t.readAsDataURL(e.originFileObj),t.onload=()=>a(t.result)})));const t=new Image;t.src=a;const s=window.open(a);null===s||void 0===s||s.document.write(t.outerHTML)},beforeUpload:()=>!1,children:Z.length>0?"":"Upload"})})})})]}),(0,F.jsx)(u.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:D?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=734.82ebcd6b.chunk.js.map